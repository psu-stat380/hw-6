<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Solutions">

<title>Homework 6 (Optional)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="sol_files/libs/clipboard/clipboard.min.js"></script>
<script src="sol_files/libs/quarto-html/quarto.js"></script>
<script src="sol_files/libs/quarto-html/popper.min.js"></script>
<script src="sol_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="sol_files/libs/quarto-html/anchor.min.js"></script>
<link href="sol_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="sol_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="sol_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="sol_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="sol_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Homework 6 (Optional)</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><span style="background-color: yellow;">Solutions</span> </p>
            </div>
    </div>
      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#question-1" id="toc-question-1" class="nav-link active" data-scroll-target="#question-1">Question 1</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><a href="https://github.com/psu-stat380/hw-6">Link to the Github repository</a></p>
<hr>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Due: Wed, May 3, 2023 @ 11:59pm
</div>
</div>
<div class="callout-body-container callout-body" style="font-size: 0.8em;">
<p>Please read the instructions carefully before submitting your assignment.</p>
<ol type="1">
<li>This assignment requires you to only upload a <code>PDF</code> file on Canvas</li>
<li>Don’t collapse any code cells before submitting.</li>
<li>Remember to make sure all your code output is rendered properly before uploading your submission.</li>
</ol>
<p>⚠️ Please add your name to the author information in the frontmatter before submitting your assignment ⚠️</p>
</div>
</div>
<p>In this assignment, we will perform various tasks involving principal component analysis (PCA), principal component regression, and dimensionality reduction.</p>
<p>We will need the following packages:</p>
<div class="cell" data-hash="sol_cache/html/unnamed-chunk-1_e03a24c3a9a199a7910e48f50ea54364">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tibble"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dplyr"</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"readr"</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyr"</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"purrr"</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"broom"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"magrittr"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"corrplot"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"report"</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"car"</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># renv::install(packages)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(packages, require, <span class="at">character.only=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br><br><br><br></p>
<hr>
<section id="question-1" class="level2">
<h2 class="anchored" data-anchor-id="question-1">Question 1</h2>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
70 points
</div>
</div>
<div class="callout-body-container callout-body">
<p>Principal component anlaysis and variable selection</p>
</div>
</div>
<section id="points-1" class="level6">
<h6 class="anchored" data-anchor-id="points-1">1.1 (5 points)</h6>
<p>The <code>data</code> folder contains a <code>spending.csv</code> dataset which is an illustrative sample of monthly spending data for a group of <span class="math inline">\(5000\)</span> people across a variety of categories. The response variable, <code>income</code>, is their monthly income, and objective is to predict the <code>income</code> for a an individual based on their spending patterns.</p>
<p>Read the data file as a tibble in R. Preprocess the data such that:</p>
<ol type="1">
<li>the variables are of the right data type, e.g., categorical variables are encoded as factors</li>
<li>all column names to lower case for consistency</li>
<li>Any observations with missing values are dropped</li>
</ol>
<div class="cell" data-hash="sol_cache/html/unnamed-chunk-2_d22df18c5b6ca1d172729071b3b53e04">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">"data/spending.csv"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 5000 Columns: 40
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (40): accessories, accommodation, alcohol, audio_equipment, beverages, b...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">accessories</th>
<th style="text-align: right;">accommodation</th>
<th style="text-align: right;">alcohol</th>
<th style="text-align: right;">audio_equipment</th>
<th style="text-align: right;">beverages</th>
<th style="text-align: right;">books</th>
<th style="text-align: right;">cameras</th>
<th style="text-align: right;">car_rentals</th>
<th style="text-align: right;">clothing</th>
<th style="text-align: right;">coffee_shops</th>
<th style="text-align: right;">dairy_products</th>
<th style="text-align: right;">desktops</th>
<th style="text-align: right;">electronics</th>
<th style="text-align: right;">fast_food</th>
<th style="text-align: right;">food_delivery</th>
<th style="text-align: right;">fruits</th>
<th style="text-align: right;">groceries</th>
<th style="text-align: right;">gym_memberships</th>
<th style="text-align: right;">jewelry</th>
<th style="text-align: right;">laptops</th>
<th style="text-align: right;">magazines</th>
<th style="text-align: right;">meat</th>
<th style="text-align: right;">movies</th>
<th style="text-align: right;">music</th>
<th style="text-align: right;">outdoor_activities</th>
<th style="text-align: right;">public_transportation</th>
<th style="text-align: right;">restaurant_meals</th>
<th style="text-align: right;">seafood</th>
<th style="text-align: right;">shoes</th>
<th style="text-align: right;">smartphones</th>
<th style="text-align: right;">snacks</th>
<th style="text-align: right;">software</th>
<th style="text-align: right;">sports_equipment</th>
<th style="text-align: right;">streaming_services</th>
<th style="text-align: right;">tablets</th>
<th style="text-align: right;">travel</th>
<th style="text-align: right;">vegetables</th>
<th style="text-align: right;">video_games</th>
<th style="text-align: right;">watches</th>
<th style="text-align: right;">income</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4.45</td>
<td style="text-align: right;">90.09</td>
<td style="text-align: right;">39.20</td>
<td style="text-align: right;">7.60</td>
<td style="text-align: right;">57.90</td>
<td style="text-align: right;">45.14</td>
<td style="text-align: right;">6.62</td>
<td style="text-align: right;">67.66</td>
<td style="text-align: right;">8.69</td>
<td style="text-align: right;">41.03</td>
<td style="text-align: right;">99.54</td>
<td style="text-align: right;">5.14</td>
<td style="text-align: right;">12.84</td>
<td style="text-align: right;">78.76</td>
<td style="text-align: right;">60.18</td>
<td style="text-align: right;">79.71</td>
<td style="text-align: right;">121.61</td>
<td style="text-align: right;">66.91</td>
<td style="text-align: right;">3.35</td>
<td style="text-align: right;">9.78</td>
<td style="text-align: right;">44.92</td>
<td style="text-align: right;">100.24</td>
<td style="text-align: right;">68.92</td>
<td style="text-align: right;">67.81</td>
<td style="text-align: right;">67.68</td>
<td style="text-align: right;">67.13</td>
<td style="text-align: right;">80.35</td>
<td style="text-align: right;">80.70</td>
<td style="text-align: right;">5.93</td>
<td style="text-align: right;">12.56</td>
<td style="text-align: right;">61.28</td>
<td style="text-align: right;">5.85</td>
<td style="text-align: right;">45.47</td>
<td style="text-align: right;">90.42</td>
<td style="text-align: right;">9.11</td>
<td style="text-align: right;">90.93</td>
<td style="text-align: right;">79.30</td>
<td style="text-align: right;">11.92</td>
<td style="text-align: right;">3.37</td>
<td style="text-align: right;">198.79</td>
</tr>
<tr class="even">
<td style="text-align: right;">10.92</td>
<td style="text-align: right;">84.86</td>
<td style="text-align: right;">28.69</td>
<td style="text-align: right;">44.30</td>
<td style="text-align: right;">43.88</td>
<td style="text-align: right;">42.29</td>
<td style="text-align: right;">27.53</td>
<td style="text-align: right;">63.80</td>
<td style="text-align: right;">16.93</td>
<td style="text-align: right;">27.65</td>
<td style="text-align: right;">70.37</td>
<td style="text-align: right;">27.41</td>
<td style="text-align: right;">72.29</td>
<td style="text-align: right;">56.23</td>
<td style="text-align: right;">42.28</td>
<td style="text-align: right;">56.40</td>
<td style="text-align: right;">84.83</td>
<td style="text-align: right;">61.63</td>
<td style="text-align: right;">6.61</td>
<td style="text-align: right;">44.35</td>
<td style="text-align: right;">41.50</td>
<td style="text-align: right;">69.12</td>
<td style="text-align: right;">62.35</td>
<td style="text-align: right;">63.18</td>
<td style="text-align: right;">61.77</td>
<td style="text-align: right;">63.62</td>
<td style="text-align: right;">56.65</td>
<td style="text-align: right;">57.41</td>
<td style="text-align: right;">14.58</td>
<td style="text-align: right;">57.26</td>
<td style="text-align: right;">41.70</td>
<td style="text-align: right;">30.70</td>
<td style="text-align: right;">40.71</td>
<td style="text-align: right;">81.92</td>
<td style="text-align: right;">45.05</td>
<td style="text-align: right;">83.09</td>
<td style="text-align: right;">56.76</td>
<td style="text-align: right;">58.56</td>
<td style="text-align: right;">5.97</td>
<td style="text-align: right;">423.35</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.77</td>
<td style="text-align: right;">18.50</td>
<td style="text-align: right;">37.53</td>
<td style="text-align: right;">13.38</td>
<td style="text-align: right;">57.34</td>
<td style="text-align: right;">8.65</td>
<td style="text-align: right;">7.13</td>
<td style="text-align: right;">15.04</td>
<td style="text-align: right;">7.69</td>
<td style="text-align: right;">37.85</td>
<td style="text-align: right;">96.32</td>
<td style="text-align: right;">7.74</td>
<td style="text-align: right;">22.36</td>
<td style="text-align: right;">75.76</td>
<td style="text-align: right;">55.09</td>
<td style="text-align: right;">77.01</td>
<td style="text-align: right;">113.12</td>
<td style="text-align: right;">14.91</td>
<td style="text-align: right;">4.17</td>
<td style="text-align: right;">14.43</td>
<td style="text-align: right;">7.99</td>
<td style="text-align: right;">95.81</td>
<td style="text-align: right;">13.65</td>
<td style="text-align: right;">16.13</td>
<td style="text-align: right;">13.78</td>
<td style="text-align: right;">13.97</td>
<td style="text-align: right;">76.06</td>
<td style="text-align: right;">76.24</td>
<td style="text-align: right;">6.59</td>
<td style="text-align: right;">16.94</td>
<td style="text-align: right;">58.07</td>
<td style="text-align: right;">8.41</td>
<td style="text-align: right;">10.16</td>
<td style="text-align: right;">18.51</td>
<td style="text-align: right;">15.71</td>
<td style="text-align: right;">17.35</td>
<td style="text-align: right;">76.93</td>
<td style="text-align: right;">19.30</td>
<td style="text-align: right;">4.64</td>
<td style="text-align: right;">154.83</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.05</td>
<td style="text-align: right;">77.77</td>
<td style="text-align: right;">33.34</td>
<td style="text-align: right;">100.67</td>
<td style="text-align: right;">51.88</td>
<td style="text-align: right;">40.58</td>
<td style="text-align: right;">65.89</td>
<td style="text-align: right;">59.22</td>
<td style="text-align: right;">24.67</td>
<td style="text-align: right;">32.74</td>
<td style="text-align: right;">83.55</td>
<td style="text-align: right;">64.86</td>
<td style="text-align: right;">164.36</td>
<td style="text-align: right;">67.17</td>
<td style="text-align: right;">50.78</td>
<td style="text-align: right;">66.08</td>
<td style="text-align: right;">99.00</td>
<td style="text-align: right;">57.91</td>
<td style="text-align: right;">10.65</td>
<td style="text-align: right;">99.06</td>
<td style="text-align: right;">40.70</td>
<td style="text-align: right;">83.55</td>
<td style="text-align: right;">58.97</td>
<td style="text-align: right;">58.44</td>
<td style="text-align: right;">59.01</td>
<td style="text-align: right;">58.39</td>
<td style="text-align: right;">65.76</td>
<td style="text-align: right;">66.20</td>
<td style="text-align: right;">19.82</td>
<td style="text-align: right;">131.39</td>
<td style="text-align: right;">50.91</td>
<td style="text-align: right;">66.74</td>
<td style="text-align: right;">39.40</td>
<td style="text-align: right;">78.12</td>
<td style="text-align: right;">97.49</td>
<td style="text-align: right;">77.90</td>
<td style="text-align: right;">67.35</td>
<td style="text-align: right;">131.61</td>
<td style="text-align: right;">9.93</td>
<td style="text-align: right;">799.07</td>
</tr>
<tr class="odd">
<td style="text-align: right;">26.94</td>
<td style="text-align: right;">12.49</td>
<td style="text-align: right;">10.10</td>
<td style="text-align: right;">82.35</td>
<td style="text-align: right;">14.55</td>
<td style="text-align: right;">6.87</td>
<td style="text-align: right;">55.79</td>
<td style="text-align: right;">6.75</td>
<td style="text-align: right;">42.70</td>
<td style="text-align: right;">8.62</td>
<td style="text-align: right;">24.49</td>
<td style="text-align: right;">53.66</td>
<td style="text-align: right;">135.44</td>
<td style="text-align: right;">18.71</td>
<td style="text-align: right;">14.01</td>
<td style="text-align: right;">19.20</td>
<td style="text-align: right;">27.67</td>
<td style="text-align: right;">8.23</td>
<td style="text-align: right;">16.94</td>
<td style="text-align: right;">80.06</td>
<td style="text-align: right;">4.70</td>
<td style="text-align: right;">21.07</td>
<td style="text-align: right;">9.85</td>
<td style="text-align: right;">9.10</td>
<td style="text-align: right;">9.68</td>
<td style="text-align: right;">8.35</td>
<td style="text-align: right;">19.36</td>
<td style="text-align: right;">17.70</td>
<td style="text-align: right;">36.33</td>
<td style="text-align: right;">109.54</td>
<td style="text-align: right;">14.87</td>
<td style="text-align: right;">52.77</td>
<td style="text-align: right;">6.17</td>
<td style="text-align: right;">11.99</td>
<td style="text-align: right;">80.76</td>
<td style="text-align: right;">12.31</td>
<td style="text-align: right;">18.75</td>
<td style="text-align: right;">108.84</td>
<td style="text-align: right;">16.95</td>
<td style="text-align: right;">617.97</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.49</td>
<td style="text-align: right;">25.72</td>
<td style="text-align: right;">29.54</td>
<td style="text-align: right;">93.76</td>
<td style="text-align: right;">42.22</td>
<td style="text-align: right;">12.67</td>
<td style="text-align: right;">60.65</td>
<td style="text-align: right;">19.82</td>
<td style="text-align: right;">7.61</td>
<td style="text-align: right;">27.29</td>
<td style="text-align: right;">68.21</td>
<td style="text-align: right;">60.22</td>
<td style="text-align: right;">153.65</td>
<td style="text-align: right;">56.14</td>
<td style="text-align: right;">40.43</td>
<td style="text-align: right;">54.29</td>
<td style="text-align: right;">80.86</td>
<td style="text-align: right;">19.78</td>
<td style="text-align: right;">3.35</td>
<td style="text-align: right;">92.67</td>
<td style="text-align: right;">14.50</td>
<td style="text-align: right;">68.51</td>
<td style="text-align: right;">19.66</td>
<td style="text-align: right;">21.93</td>
<td style="text-align: right;">21.02</td>
<td style="text-align: right;">19.52</td>
<td style="text-align: right;">53.74</td>
<td style="text-align: right;">54.17</td>
<td style="text-align: right;">6.13</td>
<td style="text-align: right;">125.08</td>
<td style="text-align: right;">41.71</td>
<td style="text-align: right;">64.04</td>
<td style="text-align: right;">12.38</td>
<td style="text-align: right;">26.11</td>
<td style="text-align: right;">93.33</td>
<td style="text-align: right;">26.23</td>
<td style="text-align: right;">53.79</td>
<td style="text-align: right;">123.86</td>
<td style="text-align: right;">3.73</td>
<td style="text-align: right;">680.76</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr>
</section>
<section id="points-2" class="level6">
<h6 class="anchored" data-anchor-id="points-2">1.2 (5 points)</h6>
<p>Visualize the correlation between the variables using the <code>corrplot()</code> function. What do you observe? What does this mean for the model?</p>
<div class="cell" data-hash="sol_cache/html/unnamed-chunk-3_a840d612dad4201e2224c1e4e2602a0b">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">keep</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="sol_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
<section id="points-3" class="level6">
<h6 class="anchored" data-anchor-id="points-3">1.3 (5 points)</h6>
<p>Run a linear regression model to predict the <code>income</code> variable using the remaining predictors. Interpret the coefficients and summarize your results.</p>
<div class="cell" data-hash="sol_cache/html/unnamed-chunk-4_814c58b72ef7534f5f245232251f6d6b">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> ., df)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = income ~ ., data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.6875 -1.6569  0.0427  1.6633  9.5623 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           -0.077509   0.121730  -0.637 0.524330    
accessories            0.299876   0.031786   9.434  &lt; 2e-16 ***
accommodation          0.113632   0.031262   3.635 0.000281 ***
alcohol               -0.005958   0.033266  -0.179 0.857873    
audio_equipment        0.602004   0.033483  17.979  &lt; 2e-16 ***
beverages              0.043335   0.034111   1.270 0.204000    
books                  0.070530   0.033238   2.122 0.033892 *  
cameras                0.461827   0.033572  13.756  &lt; 2e-16 ***
car_rentals            0.124875   0.032809   3.806 0.000143 ***
clothing               0.504228   0.026055  19.352  &lt; 2e-16 ***
coffee_shops           0.048839   0.034909   1.399 0.161864    
dairy_products         0.024548   0.032715   0.750 0.453082    
desktops               0.391673   0.033393  11.729  &lt; 2e-16 ***
electronics            1.079627   0.030035  35.946  &lt; 2e-16 ***
fast_food              0.077531   0.033014   2.348 0.018893 *  
food_delivery         -0.004903   0.034257  -0.143 0.886188    
fruits                 0.059089   0.033321   1.773 0.076237 .  
groceries              0.077694   0.031601   2.459 0.013981 *  
gym_memberships        0.141168   0.033410   4.225 2.43e-05 ***
jewelry                0.213726   0.032834   6.509 8.30e-11 ***
laptops                0.594328   0.032548  18.260  &lt; 2e-16 ***
magazines              0.080762   0.033694   2.397 0.016571 *  
meat                   0.081262   0.032367   2.511 0.012083 *  
movies                 0.110296   0.033326   3.310 0.000941 ***
music                  0.159925   0.033398   4.788 1.73e-06 ***
outdoor_activities     0.087846   0.032356   2.715 0.006651 ** 
public_transportation  0.061138   0.033022   1.851 0.064169 .  
restaurant_meals       0.066129   0.033225   1.990 0.046611 *  
seafood                0.061318   0.033786   1.815 0.069596 .  
shoes                  0.463185   0.029613  15.641  &lt; 2e-16 ***
smartphones            0.780150   0.031538  24.737  &lt; 2e-16 ***
snacks                 0.007464   0.033229   0.225 0.822290    
software               0.408500   0.034102  11.979  &lt; 2e-16 ***
sports_equipment       0.033328   0.033969   0.981 0.326574    
streaming_services     0.150614   0.031902   4.721 2.41e-06 ***
tablets                0.637266   0.033133  19.234  &lt; 2e-16 ***
travel                 0.129161   0.031457   4.106 4.09e-05 ***
vegetables            -0.066111   0.033162  -1.994 0.046257 *  
video_games            0.863309   0.031392  27.501  &lt; 2e-16 ***
watches                0.145853   0.033467   4.358 1.34e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.434 on 4960 degrees of freedom
Multiple R-squared:  0.9999,    Adjusted R-squared:  0.9999 
F-statistic: 1.834e+06 on 39 and 4960 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>For a given predictor, the coefficient represents the change in the response variable for a unit change in the predictor, holding all other predictors constant. For example, the coefficient for <code>groceries</code> is <span class="math inline">\(0.07\)</span>. This means that for a unit increase in <code>groceries</code> expenditure, the expected <code>income</code> increases by <span class="math inline">\(0.07\)</span>, <em>holding all other predictors constant</em>.</p>
</blockquote>
<hr>
</section>
<section id="points-4" class="level6">
<h6 class="anchored" data-anchor-id="points-4">1.3 (5 points)</h6>
<p>Diagnose the model using the <code>vif()</code> function. What do you observe? What does this mean for the model?</p>
<div class="cell" data-hash="sol_cache/html/unnamed-chunk-5_f47fce0833794a7fc4939400ce9ff0fb">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="sc">%&gt;%</span> <span class="fu">vif</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          accessories         accommodation               alcohol 
            152.06821             681.15504             387.23376 
      audio_equipment             beverages                 books 
           1755.56441             914.69186             192.91781 
              cameras           car_rentals              clothing 
            785.43147             423.55906             282.25143 
         coffee_shops        dairy_products              desktops 
            425.39644            2336.74847             776.75697 
          electronics             fast_food         food_delivery 
           3927.16511            1519.85171             921.68162 
               fruits             groceries       gym_memberships 
           1550.05678            3136.80325             438.30224 
              jewelry               laptops             magazines 
             72.38215            1658.76990             198.53619 
                 meat                movies                 music 
           2284.43676             437.28082             437.03990 
   outdoor_activities public_transportation      restaurant_meals 
            411.17302             427.77815            1540.26240 
              seafood                 shoes           smartphones 
           1594.08027             233.33301            2772.27822 
               snacks              software      sports_equipment 
            868.24282             810.28919             201.00255 
   streaming_services               tablets                travel 
            709.25592            1718.78339             690.69616 
           vegetables           video_games               watches 
           1536.40686            2745.64421              75.56457 </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>The coefficients and their significance in <code>model1</code> are not reliable because of the high multicollinearity between the predictors. This is evident from the high VIF values for the predictors.</p>
</blockquote>
<hr>
</section>
<section id="points-5" class="level6">
<h6 class="anchored" data-anchor-id="points-5">1.4 (5 points)</h6>
<p>Perform PCA using the <code>princomp</code> function in R. Print the summary of the PCA object.</p>
<div class="cell" data-hash="sol_cache/html/unnamed-chunk-6_e681cf150a38e33e9f9639e85c6ef1d5">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>income) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">princomp</span>(<span class="at">cor =</span> T)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          Comp.1    Comp.2    Comp.3    Comp.4       Comp.5
Standard deviation     3.6201099 3.4479976 2.9939875 2.2288727 0.1125697569
Proportion of Variance 0.3360307 0.3048381 0.2298452 0.1273814 0.0003249218
Cumulative Proportion  0.3360307 0.6408688 0.8707140 0.9980954 0.9984202743
                             Comp.6       Comp.7       Comp.8       Comp.9
Standard deviation     0.0960605322 0.0708312069 0.0691539249 0.0670242037
Proportion of Variance 0.0002366058 0.0001286426 0.0001226222 0.0001151857
Cumulative Proportion  0.9986568801 0.9987855227 0.9989081448 0.9990233306
                            Comp.10      Comp.11      Comp.12      Comp.13
Standard deviation     0.0653196274 5.099363e-02 0.0498072940 4.762347e-02
Proportion of Variance 0.0001094014 6.667565e-05 0.0000636094 5.815371e-05
Cumulative Proportion  0.9991327320 9.991994e-01 0.9992630170 9.993212e-01
                            Comp.14      Comp.15      Comp.16      Comp.17
Standard deviation     0.0469865879 4.611213e-02 0.0459026903 4.552808e-02
Proportion of Variance 0.0000566087 5.452125e-05 0.0000540271 5.314888e-05
Cumulative Proportion  0.9993777794 9.994323e-01 0.9994863278 9.995395e-01
                            Comp.18      Comp.19      Comp.20      Comp.21
Standard deviation     4.516751e-02 3.944038e-02 0.0358645643 3.505209e-02
Proportion of Variance 5.231037e-05 3.988573e-05 0.0000329812 3.150383e-05
Cumulative Proportion  9.995918e-01 9.996317e-01 0.9996646540 9.996962e-01
                            Comp.22      Comp.23      Comp.24      Comp.25
Standard deviation     3.460809e-02 3.435268e-02 3.297822e-02 3.240319e-02
Proportion of Variance 3.071076e-05 3.025915e-05 2.788623e-05 2.692223e-05
Cumulative Proportion  9.997269e-01 9.997571e-01 9.997850e-01 9.998119e-01
                            Comp.26      Comp.27      Comp.28      Comp.29
Standard deviation     3.135574e-02 2.976920e-02 2.508623e-02 2.460025e-02
Proportion of Variance 2.520981e-05 2.272321e-05 1.613638e-05 1.551723e-05
Cumulative Proportion  9.998371e-01 9.998599e-01 9.998760e-01 9.998915e-01
                            Comp.30      Comp.31      Comp.32      Comp.33
Standard deviation     2.426600e-02 2.374599e-02 2.334190e-02 2.283049e-02
Proportion of Variance 1.509843e-05 1.445825e-05 1.397036e-05 1.336491e-05
Cumulative Proportion  9.999066e-01 9.999211e-01 9.999350e-01 9.999484e-01
                            Comp.34      Comp.35      Comp.36      Comp.37
Standard deviation     2.119139e-02 1.968544e-02 1.937808e-02 1.742835e-02
Proportion of Variance 1.151475e-05 9.936319e-06 9.628464e-06 7.788395e-06
Cumulative Proportion  9.999599e-01 9.999699e-01 9.999795e-01 9.999873e-01
                            Comp.38      Comp.39
Standard deviation     1.677847e-02 1.464440e-02
Proportion of Variance 7.218385e-06 5.498931e-06
Cumulative Proportion  9.999945e-01 1.000000e+00</code></pre>
</div>
</div>
<hr>
</section>
<section id="points-6" class="level6">
<h6 class="anchored" data-anchor-id="points-6">1.5 (5 points)</h6>
<p>Make a screeplot of the proportion of variance explained by each principal component. How many principal components would you choose to keep? Why?</p>
<div class="cell" data-hash="sol_cache/html/unnamed-chunk-7_44ae57d77081f39bd400089850641b61">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca, <span class="at">type=</span><span class="st">"l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="sol_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>I would choose to keep the first 4 principal components because they explain <span class="math inline">\(99.8\%\)</span> of the variance and correspond to the “elbow” in the screeplot.</p>
</blockquote>
<hr>
</section>
<section id="points-7" class="level6">
<h6 class="anchored" data-anchor-id="points-7">1.6 (5 points)</h6>
<p>By setting any factor loadings below <span class="math inline">\(0.2\)</span> to <span class="math inline">\(0\)</span>, summarize the factor loadings for the principal components that you chose to keep.</p>
<div class="cell" data-hash="sol_cache/html/unnamed-chunk-8_fca203cffd0105634282fa906c26e7e4">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>clean_loadings <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>(pca<span class="sc">$</span>loadings[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">&lt;</span> <span class="fl">0.1</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(pca<span class="sc">$</span>loadings[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">2</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualize the factor loadings.</p>
<div class="cell" data-hash="sol_cache/html/unnamed-chunk-9_c75040db768fc19038345fdc561c687a">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>clean_loadings <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="sol_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
<section id="points-8" class="level6">
<h6 class="anchored" data-anchor-id="points-8">1.7 (15 points)</h6>
<p>Based on the factor loadings, what do you think the principal components represent?</p>
<p>Provide an interpreation for each principal component you chose to keep.</p>
<blockquote class="blockquote">
<p>By choosing 4 latent variables to explain <span class="math inline">\(99.8\%\)</span> of the variance, we can interpret them as follows:</p>
</blockquote>
<blockquote class="blockquote">
<ol type="1">
<li><strong>Apparel and Accessories Spending:</strong></li>
</ol>
<p>This latent variable represents spending on clothing, shoes, accessories, jewelry, and watches.</p>
<ol start="2" type="1">
<li><strong>Technology Spending:</strong></li>
</ol>
<p>This latent variable captures spending on electronics, smartphones, tablets, laptops, desktops, audio equipment, cameras, video games, and software.</p>
<ol start="3" type="1">
<li><strong>Food and Beverage Spending:</strong></li>
</ol>
<p>This latent variable represents spending on groceries, meat, seafood, dairy products, fruits, vegetables, snacks, beverages, alcohol, fast food, restaurant meals, coffee shops, and food delivery.</p>
<ol start="4" type="1">
<li><strong>Entertainment and Travel Spending:</strong></li>
</ol>
<p>This latent variable captures spending on books, magazines, movies, music, streaming services, sports equipment, gym memberships, outdoor activities, travel, accommodation, car rentals, and public transportation.</p>
</blockquote>
<hr>
</section>
<section id="points-9" class="level6">
<h6 class="anchored" data-anchor-id="points-9">1.8 (10 points)</h6>
<p>Create a new data frame with the original response variable <code>income</code> and the principal components you chose to keep. Call this data frame <code>df_pca</code>.</p>
<div class="cell" data-hash="sol_cache/html/unnamed-chunk-10_efdbf0b2c46e57b4f3d8866c651313e9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df_pca <span class="ot">&lt;-</span> <span class="fu">predict</span>(pca, df) <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income =</span> df[[<span class="st">"income"</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fit a regression model to predict the <code>income</code> variable using the principal components you chose to keep. Interpret the coefficients and summarize your results.</p>
<div class="cell" data-hash="sol_cache/html/unnamed-chunk-11_588136d79a5c166a33ba25c926af11ac">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> . , df_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compare the results of the regression model in 1.3 and 1.9. What do you observe? What does this mean for the model?</p>
<div class="cell" data-hash="sol_cache/html/unnamed-chunk-12_5ae2d54991b7b677debc6d67c9100bb3">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = income ~ ., data = df_pca)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.7419  -2.0122   0.0105   1.9804  14.5749 

Coefficients:
             Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept) 628.17783    0.04135 15192.91   &lt;2e-16 ***
Comp.1       13.33571    0.01142  1167.61   &lt;2e-16 ***
Comp.2       -1.16303    0.01199   -96.99   &lt;2e-16 ***
Comp.3       95.58547    0.01381  6921.50   &lt;2e-16 ***
Comp.4        9.54163    0.01855   514.36   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.924 on 4995 degrees of freedom
Multiple R-squared:  0.9999,    Adjusted R-squared:  0.9999 
F-statistic: 1.239e+07 on 4 and 4995 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="sc">%&gt;%</span> <span class="fu">vif</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Comp.1 Comp.2 Comp.3 Comp.4 
     1      1      1      1 </code></pre>
</div>
</div>
<hr>
</section>
<section id="points-10" class="level6">
<h6 class="anchored" data-anchor-id="points-10">1.10 (10 points)</h6>
<p>Based on your interpretation of the principal components from Question 1.7, provide an interpretation of the regression model in Question 1.9.</p>
<blockquote class="blockquote">
<p>The regression model in <strong>Q1.9</strong> is a linear combination of the 4 latent variables we identified in <strong>Q1.7</strong>. The coefficients represent the change in the response variable for a unit change in the latent variable, holding all other latent variables constant. For example, the coefficient for <code>Comp.1</code> is <span class="math inline">\(13.33\)</span>. This means that for a unit increase in <code>Apparel and Accessories spending</code>, the expected <code>income</code> increases by <span class="math inline">\(13.33\)</span>, <em>holding all other latent variables constant</em>.</p>
</blockquote>
<hr>
<div class="hidden" data-unless-format="pdf">
<div style="page-break-after: always;"></div>
</div>
<p><br><br><br><br> <br><br><br><br></p>
<hr>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Session Information
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Print your <code>R</code> session information using the following command</p>
<div class="cell" data-hash="sol_cache/html/unnamed-chunk-13_d448cf1e9f30f4033c30154099c9355d">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-conda-linux-gnu (64-bit)
Running under: Storage

Matrix products: default
BLAS/LAPACK: /gpfs/group/hvt5139/default/tools/mambaforge/lib/libopenblasp-r0.3.21.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
 [1] report_0.5.7     car_3.1-1        carData_3.0-5    tibble_3.1.8    
 [5] luz_0.3.1        torch_0.9.0      e1071_1.7-13     rpart.plot_3.1.1
 [9] rpart_4.1.19     caret_6.0-94     lattice_0.20-45  ggplot2_3.4.1   
[13] corrplot_0.92    magrittr_2.0.3   broom_1.0.4      purrr_1.0.1     
[17] tidyr_1.3.0      readr_2.1.4      dplyr_1.1.0     

loaded via a namespace (and not attached):
 [1] nlme_3.1-162         fs_1.6.1             lubridate_1.9.2     
 [4] bit64_4.0.5          insight_0.19.1       progress_1.2.2      
 [7] tools_4.2.2          backports_1.4.1      utf8_1.2.3          
[10] R6_2.5.1             colorspace_2.1-0     nnet_7.3-18         
[13] withr_2.5.0          tidyselect_1.2.0     prettyunits_1.1.1   
[16] processx_3.8.0       bit_4.0.5            compiler_4.2.2      
[19] cli_3.6.0            scales_1.2.1         callr_3.7.3         
[22] proxy_0.4-27         stringr_1.5.0        digest_0.6.31       
[25] rmarkdown_2.20       coro_1.0.3           pkgconfig_2.0.3     
[28] htmltools_0.5.4      parallelly_1.35.0    fastmap_1.1.0       
[31] htmlwidgets_1.6.2    rlang_1.0.6          generics_0.1.3      
[34] jsonlite_1.8.4       ModelMetrics_1.2.2.2 Matrix_1.5-3        
[37] Rcpp_1.0.10          munsell_0.5.0        fansi_1.0.4         
[40] abind_1.4-5          lifecycle_1.0.3      stringi_1.7.12      
[43] pROC_1.18.0          yaml_2.3.7           MASS_7.3-58.3       
[46] plyr_1.8.8           recipes_1.0.5        grid_4.2.2          
[49] parallel_4.2.2       listenv_0.9.0        crayon_1.5.2        
[52] splines_4.2.2        hms_1.1.2            zeallot_0.1.0       
[55] knitr_1.42           ps_1.7.2             pillar_1.8.1        
[58] future.apply_1.10.0  reshape2_1.4.4       codetools_0.2-19    
[61] stats4_4.2.2         glue_1.6.2           evaluate_0.20       
[64] data.table_1.14.8    renv_0.16.0-53       vctrs_0.5.2         
[67] tzdb_0.3.0           foreach_1.5.2        gtable_0.3.1        
[70] future_1.32.0        xfun_0.37            gower_1.0.1         
[73] prodlim_2019.11.13   class_7.3-21         survival_3.5-5      
[76] timeDate_4022.108    iterators_1.0.14     hardhat_1.2.0       
[79] lava_1.7.2.1         timechange_0.2.0     globals_0.16.2      
[82] ellipsis_0.3.2       ipred_0.9-14        </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>